# DataLakePaper
python library for Data Lake (model: data vault) visualization using excel (it will be a real wall paper of A4 sheets)

[RU/EN]

Идея в следующем.

1. Из Jupyter запускаем команду создать проект.
Появляется каталог с файлами 01_document.xls и 01_example.xls.
Файлы одинаковые практически, только draft пустой, а в example есть пара примеров.

В файлах 5 листов (изменения, описание, таблицы, аттрибуты, примеры).
Пользователь их заполняет по своим источникам и сохраняет готовый файл в 01_document.xls.

2. Из Jupyter запускаем команду создать схему data vault.
В каталоге появится файл 02_schema.xls и 02_sample.xls.
Файлы одинаковые практически, только schema пустой, а в example есть пара примеров.

В нем новые вкладки: hubs, links for hubs, links for links, links for links for links, sattelites, mappings, etl 0, etl 1, etl 2, etl 3, etl 4.

Пользователь их заполняет по минимуму хотя бы hubs и сохраняет готовый файл в 02_schema.xls.

3. Из Jupyter запускаем команду создать карту data lake.
В каталоге появится файл 03_lake.xls и 03_dummy.xls.
Файлы одинаковые практически, только dummy пустой или с примерами, а в lake подготовленная визуализация.

В нем новые вкладки: lake

Пользователь их комментирует и меняет по минимуму и сохраняет готовый файл в 03_lake.xls.

Алгоритм авто построения следующий - решается задача о расположении графа на плоскости.
Параметрами заданы размеры узловых кругов и фиксированное расстояние.

Размер таблицы задает прямоугольник, вокруг которого мы описываем окружность.
Эту окружность мы заменим на цепочку узловых кругов (вписанный n угольник).

Остальные связи подбираем по верхней левой точке таблицы без учета какой fk куда приходит.
Получаем решение об оптимальном расположении графа на плоскости.

Убираем связи между таблицами и рисуем их заново по всем fk.
Желательно для этого продумать внутренний формат хранения вида yaml.

Теперь все стрелки под углом мы заменяем на excel формат оформления границ (например, только сверху или сверху и справа).
Стрелку делим на 4 ступеньки примерно в равных пропорциях, но стараемся, чтобы не пересекались разные стрелки более чем в одной ячейке.

В итоге таблицы делим по префиксам H_ - квадрат, S_ - круг, L - ромб и тоже оформляем выделениями, нумеруем N0001.t1, N00002.t2 и т д. Прорисовываем над H_ и S_ view (обводка с отступом в 2 ячейки), также делаем для L_ и S_ или L_ и L_ и S_ и S_.
Дополнительно находим границы листов A4 и отмечаем в нижнем правом углу буквами координаты, например E1.

4. Из Jupyter запускаем команду создать бумагу data paper.
В каталоге появится файл 04_paper.xls и 04_empty.xls.
Файлы одинаковые практически, только empty пустой или с примерами, а в paper подготовленные обои.

В нем новые вкладки: N00001.A1, N000002.A2, ... N000064.E2
Их можно отправить на печать и получить обои на стену.

Алгоритм должен не посто скопировать ячейки из файла 03_lake.xls в 04_paper.xls, но и разнести по ячейкам длинный текст (расчет ширины букв).

Вот как-то так.
Успехов в работе!




